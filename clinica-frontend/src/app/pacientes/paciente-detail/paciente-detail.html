<div class="detail-container">
  <button mat-stroked-button class="back-button" (click)="volver()">
    <mat-icon>arrow_back</mat-icon> Volver al Dashboard
  </button>

  @if (errorCarga) {
    <div class="error-card">
      <mat-card class="mat-error-card">
        <mat-card-content>{{ errorCarga }}</mat-card-content>
      </mat-card>
    </div>
  } @else if (paciente$ | async; as paciente) {
    @if (paciente) {
      <mat-sidenav-container class="sidenav-container">

        <!-- 游댳 Sidenav lateral -->
        <mat-sidenav
          #sidenav
          class="sidenav-panel"
          [mode]="window.innerWidth > 900 ? 'side' : 'over'"
          [opened]="window.innerWidth > 900"
        >
          <div class="sidenav-header">
            <h3>Secciones del Paciente</h3>
            <button
              mat-icon-button
              class="toggle-btn"
              (click)="cerrarSidenav()"
              aria-label="Cerrar men칰"
            >
              <mat-icon>close</mat-icon>
            </button>
          </div>

          <mat-nav-list>
            <a mat-list-item routerLink="./datos-personales" routerLinkActive="active-link" (click)="window.innerWidth <= 900 && cerrarSidenav()">
              <mat-icon>person_outline</mat-icon>
              <span>Datos Personales</span>
            </a>
            <a mat-list-item routerLink="./alergias" routerLinkActive="active-link" (click)="window.innerWidth <= 900 && cerrarSidenav()">
              <mat-icon>sick</mat-icon>
              <span>Alergias y Transf.</span>
            </a>
            <a mat-list-item routerLink="./antecedentes" routerLinkActive="active-link" (click)="window.innerWidth <= 900 && cerrarSidenav()">
              <mat-icon>assignment</mat-icon>
              <span>Antecedentes</span>
            </a>
            <a mat-list-item routerLink="./medicacion" routerLinkActive="active-link" (click)="window.innerWidth <= 900 && cerrarSidenav()">
              <mat-icon>medication</mat-icon>
              <span>Medicaci칩n</span>
            </a>
            <a mat-list-item routerLink="./historia" routerLinkActive="active-link" (click)="window.innerWidth <= 900 && cerrarSidenav()">
              <mat-icon>history</mat-icon>
              <span>Historia Cl칤nica</span>
            </a>
            <a mat-list-item routerLink="./dialisis" routerLinkActive="active-link" (click)="window.innerWidth <= 900 && cerrarSidenav()">
              <mat-icon>monitor_heart</mat-icon>
              <span>Par치m. Di치lisis</span>
            </a>
            <a mat-list-item routerLink="./evolucion" routerLinkActive="active-link" (click)="window.innerWidth <= 900 && cerrarSidenav()">
              <mat-icon>assessment</mat-icon>
              <span>Evoluci칩n Mensual</span>
            </a>
          </mat-nav-list>
        </mat-sidenav>

        <!-- 游댳 Contenido principal -->
        <mat-sidenav-content class="content-panel">

          <!-- Header visible solo en m칩vil -->
          <div class="sidenav-mobile-header" *ngIf="window.innerWidth <= 900">
            <button
              mat-icon-button
              (click)="abrirSidenav()"
              aria-label="Abrir men칰"
            >
              <mat-icon>menu</mat-icon>
            </button>
            <h3>Secciones del Paciente</h3>
          </div>

          <!-- Bot칩n para abrir sidenav en desktop cuando est치 cerrado -->
          <div class="sidenav-desktop-toggle" *ngIf="window.innerWidth > 900 && !sidenav.opened">
            <button
              mat-icon-button
              (click)="abrirSidenav()"
              aria-label="Abrir men칰"
            >
              <mat-icon>menu</mat-icon>
            </button>
          </div>

          <div class="patient-header">
            <h2>{{ paciente.nombre }} {{ paciente.apellido }}</h2>
            <p>ID: {{ paciente.id }} | Documento: {{ paciente.documento }}</p>
          </div>

          <div class="patient-content">
            <router-outlet></router-outlet>
          </div>
        </mat-sidenav-content>

      </mat-sidenav-container>
    } @else {
      <p class="no-data">No se encontraron datos para este paciente.</p>
    }
  } @else {
    <div class="loading">Cargando datos del paciente...</div>
  }
</div>
